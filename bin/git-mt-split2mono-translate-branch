#!/bin/bash

. "$(dirname "$0")"/mt-helpers/init.sh
helper mt_split2mono
helper mt_split2mono_translate_branch

usage() {
    printf "%s\n"                                                      \
        " usage: git $COMMAND_FROM_GIT <branch> "                      \
        "           [--upstream <upstream>]..."                        \
        "           [--skip <skip>]..."                                \
        "           <ref>:<dir>..."                                    \
        "   <branch>      the branch to interleave"                    \
        "   <upstream>... monorepo upstream branches for <branch>"     \
        "   <ref>...      the refs for split branches to combine"      \
        "   <dir>...      the dirs for each split branch"              \
        ""                                                             \
        "   optimization:"                                             \
        "   <skip>...     split <ref>s in the upstreams"               \
        ""                                                             \
        "   updates these:"                                            \
        "   refs/mt/split/<branch>/<dir>/head -> <split-commit>"       \
        "   refs/mt/split/<branch>/<dir>/next -> <split-commit>"       \
        "   refs/mt/split/<branch>/<dir>/tail -> <split-commit>"
}

mt_split2mono_init &&
mt_split2mono_translate_branch "$@"
